SELECT COUNT(DISTINCT R.KYRES) AS NB_SEJOURS
FROM RSM R
WHERE R.CDRELIE IS NOT NULL
AND TRIM(R.CDRELIE) IS NOT NULL
AND (R.CDDNC9 IS NULL OR SUBSTR(TRIM(R.CDDNC9),1,1) <> 'Z')
AND R.D8EEUE >= TO_DATE('01/01/2025','DD/MM/YYYY')
AND R.D8EEUE <  TO_DATE('01/12/2025','DD/MM/YYYY');
