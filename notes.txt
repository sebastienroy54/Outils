import smtplib
from email.message import EmailMessage
import os
from pathlib import Path

def send_mail(subject, body, attachments=None):
    if attachments is None:
        attachments = []

    msg = EmailMessage()
    msg["From"] = os.environ["MAIL_FROM"]
    msg["To"] = os.environ["MAIL_TO"]
    msg["Subject"] = subject
    msg.set_content(body)

    for f in attachments:
        path = Path(f)
        msg.add_attachment(
            path.read_bytes(),
            maintype="application",
            subtype="octet-stream",
            filename=path.name
        )

    with smtplib.SMTP(os.environ["MAIL_HOST"], int(os.environ["MAIL_PORT"])) as s:
        s.send_message(msg)
