SELECT COUNT(DISTINCT R.KYRES) AS NB_SEJOURS
FROM RSM R, DGN D, RSS S
WHERE D.KYRES(+) = R.KYRES
AND S.NODA = R.NODA
AND R.CDURM_P IN ('071','071S')
AND R.D8EEUE >= TO_DATE('01/01/2024','DD/MM/YYYY')
AND R.D8EEUE <  TO_DATE('01/01/2026','DD/MM/YYYY')
AND (R.CDDNC9 LIKE 'L97%' OR R.CDRELIE LIKE 'L97%' OR D.KYCDDG LIKE 'L97%')
AND SUBSTR(S.CDGHM,3,1) = 'C';
