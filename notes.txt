-	vrais doublons (NDA1 <> NDA2 and UMA1 = UMA2 and DateE1 = DateE2 and DateS1 = DateS2) ;
-	autres doublons 0 nuit (NDA1 <> NDA2 and UMA1 <> UMA2 and DateE1 = DateE2 and DateS1 = DateS2) ;
-	séjours en chevauchement ou en inclusion (NDA1 <> NDA2 and UMA1 <> UMA2 and DateS1 between DE1+1 et Dates2) ;
-	séjours contigus (NDA1 <> NDA2 and UMA1 <> UMA2 and Dates1 = DateE2).


SET SERVEROUTPUT ON
DECLARE
    v_sql VARCHAR2(4000);
    v_count NUMBER;
BEGIN
    FOR col IN (
        SELECT COLUMN_NAME
        FROM ALL_TAB_COLUMNS
        WHERE TABLE_NAME = 'SDO'
          AND DATA_TYPE IN ('VARCHAR2','CHAR')
    ) LOOP
        v_sql := 'SELECT COUNT(*) FROM SDO WHERE ' || col.COLUMN_NAME || ' = ''CODE''';
        EXECUTE IMMEDIATE v_sql INTO v_count;
        IF v_count > 0 THEN
            DBMS_OUTPUT.PUT_LINE('Colonne : ' || col.COLUMN_NAME || ' contient ''CODE'' (' || v_count || ' occurrence(s))');
        END IF;
    END LOOP;
END;
/

SP2-0734: commande inconnue au début de "SUM(CASE W..." - le reste de la ligne est ignoré.
SP2-0734: commande inconnue au début de "THEN 1 ELS..." - le reste de la ligne est ignoré.
SP2-0734: commande inconnue au début de "SUM(NVL(RU..." - le reste de la ligne est ignoré.
SP2-0042: commande inconnue "SUM(" - reste de la ligne ignoré.
SP2-0042: commande inconnue "CASE" - reste de la ligne ignoré.
SP2-0734: commande inconnue au début de "WHEN (NVL(..." - le reste de la ligne est ignoré.
SP2-0734: commande inconnue au début de "THEN NVL(R..." - le reste de la ligne est ignoré.
SP2-0044: Pour la liste des commandes connues entrez HELP
and et pour sortir EXIT.
SP2-0042: commande inconnue "ELSE 0" - reste de la ligne ignoré.
SP2-0042: commande inconnue "END" - reste de la ligne ignoré.
SP2-0734: commande inconnue au début de ") AS NB_JO..." - le reste de la ligne est ignoré.
SP2-0042: commande inconnue "ROUND(" - reste de la ligne ignoré.
SP2-0734: commande inconnue au début de "CASE WHEN ..." - le reste de la ligne est ignoré.
SP2-0734: commande inconnue au début de "ELSE (SUM(..." - le reste de la ligne est ignoré.
SP2-0734: commande inconnue au début de "THEN 1 ELS..." - le reste de la ligne est ignoré.
SP2-0044: Pour la liste des commandes connues entrez HELP
and et pour sortir EXIT.
SP2-0042: commande inconnue "END, 1" - reste de la ligne ignoré.
SP2-0734: commande inconnue au début de ") AS PCT_R..." - le reste de la ligne est ignoré.
SP2-0042: commande inconnue "ROUND(" - reste de la ligne ignoré.
SP2-0734: commande inconnue au début de "CASE WHEN ..." - le reste de la ligne est ignoré.
SP2-0042: commande inconnue "ELSE (" - reste de la ligne ignoré.
SP2-0042: commande inconnue "SUM(" - reste de la ligne ignoré.
SP2-0044: Pour la liste des commandes connues entrez HELP
and et pour sortir EXIT.
SP2-0734: commande inconnue au début de "CASE WHEN ..." - le reste de la ligne est ignoré.
SP2-0734: commande inconnue au début de "THEN NVL(R..." - le reste de la ligne est 
