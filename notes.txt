Serait-il possible d’avoir une extraction pour 2025 : 
1.	Les passages au SAU avec date pour les patients passés par HC Médecine Interne (UH 010) et HDS Médecine Interne (UH 010S)
2.	L’ensemble des RUM avec dates entrée/sortie des patients passés par HC MI et HDS MI
3.	Les séjours en UHCD avec date, DP et DAS pour les patients passés par HC MI et HDS MI

Pour contexte, nous aimerions essayer d’avoir des casemix des patients hospitalisés en médecine interne avec entrée directe via médecine de ville, via passage par SAU et via passage en UHCD.


passage SAU MI:
SELECT DISTINCT
    R.NOIP AS IPP,
    R.NODA AS NDA,
    R.CDURM_P AS UM_MI,
    TO_CHAR(R.D8EEUE,'DD/MM/YYYY HH24:MI:SS') AS ENTREE_MI,
    TO_CHAR(R.D8SOUE,'DD/MM/YYYY HH24:MI:SS') AS SORTIE_MI
FROM
    RSM R
WHERE
    R.CDURM_P IN ('010','010S')
    AND R.PASPSTRUCTURG IN ('5','U','V')
    AND R.D8EEUE >= TO_DATE('01/01/2025','DD/MM/YYYY')
    AND R.D8EEUE <  TO_DATE('01/01/2026','DD/MM/YYYY')
ORDER BY
    R.NOIP;

passage UHCD MI:
SELECT
    IPP,
    NDA,
    KYRES,
    UM_UHCD,
    TO_CHAR(ENTREE_UHCD,'DD/MM/YYYY HH24:MI:SS') AS ENTREE_UHCD,
    TO_CHAR(SORTIE_UHCD,'DD/MM/YYYY HH24:MI:SS') AS SORTIE_UHCD,
    DP,
    MAX(CASE WHEN RN = 1 THEN DAS END) AS DAS1,
    MAX(CASE WHEN RN = 2 THEN DAS END) AS DAS2,
    MAX(CASE WHEN RN = 3 THEN DAS END) AS DAS3,
    MAX(CASE WHEN RN = 4 THEN DAS END) AS DAS4
FROM
(
    SELECT
        U.NOIP    AS IPP,
        U.NODA    AS NDA,
        U.KYRES   AS KYRES,
        U.CDURM_P AS UM_UHCD,
        U.D8EEUE  AS ENTREE_UHCD,
        U.D8SOUE  AS SORTIE_UHCD,
        U.CDDNC9  AS DP,
        D.KYCDDG  AS DAS,
        ROW_NUMBER() OVER (PARTITION BY U.KYRES ORDER BY D.KYCDDG) AS RN,
        ROW_NUMBER() OVER (PARTITION BY M.KYRES ORDER BY U.D8SOUE DESC) AS RN_UHCD_MI
    FROM
        RSM U,
        RSM M,
        DGN D
    WHERE
        D.KYRES(+) = U.KYRES
        AND U.CDURM_P IN ('540','543')
        AND U.D8EEUE >= TO_DATE('01/01/2025','DD/MM/YYYY')
        AND U.D8EEUE <  TO_DATE('01/01/2026','DD/MM/YYYY')
        AND M.CDURM_P IN ('010','010S')
        AND M.D8EEUE >= TO_DATE('01/01/2025','DD/MM/YYYY')
        AND M.D8EEUE <  TO_DATE('01/01/2026','DD/MM/YYYY')
        AND M.NOIP = U.NOIP
        AND U.D8SOUE <= M.D8EEUE
        AND U.D8SOUE >  M.D8EEUE - 1
)
WHERE
    RN_UHCD_MI = 1
GROUP BY
    IPP, NDA, KYRES, UM_UHCD, ENTREE_UHCD, SORTIE_UHCD, DP
ORDER BY
    SORTIE_UHCD, IPP;

RUM MI:
SELECT
    R1.NOIP AS IPP,
    U.NODA AS NDA,
    U.NORES AS KYRES,
    U.CDURM AS UM_RUM,
    TO_CHAR(U.D8EEUE,'DD/MM/YYYY HH24:MI:SS') AS ENTREE_RUM,
    TO_CHAR(U.D8SOUE,'DD/MM/YYYY HH24:MI:SS') AS SORTIE_RUM
FROM
    RUM U,
    RSM R1
WHERE
    U.NORES = R1.KYRES
    AND U.D8EEUE >= TO_DATE('01/01/2025','DD/MM/YYYY')
    AND U.D8EEUE <  TO_DATE('01/01/2026','DD/MM/YYYY')
    AND R1.NOIP IN (
        SELECT DISTINCT R2.NOIP
        FROM RSM R2
        WHERE R2.CDURM_P IN ('010','010S')
          AND R2.D8EEUE >= TO_DATE('01/01/2025','DD/MM/YYYY')
          AND R2.D8EEUE <  TO_DATE('01/01/2026','DD/MM/YYYY')
    )
ORDER BY
    R1.NOIP, U.D8EEUE;


Désolée je n’arrive pas à traiter la donnée proprement. Auriez-vous un moyen / une idée pour connaître le casemix en diagnostics des patients venus en admission directe en HC MI CCH en 2025 et non connus du service donc qui respectent ces conditions : pas de passage au SAU avant leur admission, premier RUM = MI CCH (dc pas de passage en UHCD), jamais vu en MI CCH sur les deux dernières années.
