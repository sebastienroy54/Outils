def lire_table_excel(fichier):
    wb = load_workbook(fichier, data_only=True)
    sheet = wb.active

    # Cherche une vraie table Excel (tableau structur√©)
    if sheet.tables:
        nom_table = list(sheet.tables.keys())[0]
        table = sheet.tables[nom_table]

        # Adresse de la table (ex : "B3:F200")
        ref = table.ref
        df = pd.read_excel(fichier, engine="openpyxl", sheet_name=sheet.title, usecols=ref)
        return df

    # Sinon on lit toute la feuille (fallback)
    return pd.read_excel(fichier, dtype=str)
