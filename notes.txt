import subprocess
from pathlib import Path

def run_sqlplus(sql_file: Path, output_dir: Path,
                host: str, port: int, user: str, password: str):

    output_dir.mkdir(parents=True, exist_ok=True)

    connect = f"{user}/{password}@{host}:{port}"
    cmd = f"sqlplus -S {connect} @{sql_file}"

    subprocess.run(cmd, shell=True, check=True)
