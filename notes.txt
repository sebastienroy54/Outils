SET HEADING ON
SET FEEDBACK OFF
SET PAGESIZE 6000
SET LINESIZE 300
SET COLSEP ';'
SET TRIMSPOOL ON
SET WRAP OFF
SET TERMOUT OFF

SELECT MAX(NB_DAS) AS MAX_DAS
FROM (
      SELECT DGN.KYRES, COUNT(*) AS NB_DAS
      FROM   DGN,
             (
              SELECT DISTINCT RSM.KYRES AS KYRES
              FROM   RSM, RUM
              WHERE  RSM.KYRES = RUM.NORES
              AND    RUM.D8SOUE >= TO_DATE('01/01/2025','DD/MM/YYYY')
              AND    RUM.D8SOUE <  TO_DATE('01/01/2026','DD/MM/YYYY')
              AND    RSM.CDURM_P IN ('071S','071')
             ) K
      WHERE  DGN.KYRES = K.KYRES
      GROUP BY DGN.KYRES
     );
