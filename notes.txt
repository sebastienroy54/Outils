SELECT DISTINCT
    RSM.NOIP,
    RSM.D8EEUE,
    RSM.CDDNC9 AS DP,
    DGN.KYCDDG AS DAS
FROM RSM, DGN, SDO S
WHERE RSM.KYRES = DGN.KYRES(+)
  AND RSM.KYNODA = S.KYNODA
  AND (RSM.CDDNC9 LIKE 'O95%' OR DGN.KYCDDG LIKE 'O95%')
  AND S.DANAIS < TO_DATE('01/01/2012','DD/MM/YYYY')
  AND RSM.D8EEUE BETWEEN TO_DATE('01/01/2025','DD/MM/YYYY')
                     AND TO_DATE('31/12/2025','DD/MM/YYYY')
;
