SELECT S.CDGHM, COUNT(DISTINCT S.KYRSS)
FROM RSM R, RUM U, RSS S
WHERE U.NORES = R.KYRES
AND U.KYRSS = S.KYRSS
AND R.CDURM_P IN ('140J','142J')
AND R.D8EEUE >= TO_DATE('01/01/2024','DD/MM/YYYY')
AND R.D8EEUE <  TO_DATE('01/01/2025','DD/MM/YYYY')
AND R.CDDNC9 LIKE 'O04%'
GROUP BY S.CDGHM
ORDER BY COUNT(DISTINCT S.KYRSS) DESC;
