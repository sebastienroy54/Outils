def export_excel_with_date_formats(df: pd.DataFrame, out_path: str, sheet_name: str = "data"):
    with pd.ExcelWriter(out_path, engine="openpyxl") as writer:
        df.to_excel(writer, index=False, sheet_name=sheet_name)
        ws = writer.sheets[sheet_name]
        headers = [cell.value for cell in ws[1]]

        # Ajout "SAG Date" pour le fichier absents_actionnables
        date_cols = {"Date de pose", "Date de naissance", "Date fichcomp", "SAG Date"}
        date_col_indexes = [i + 1 for i, h in enumerate(headers) if h in date_cols]

        for col_idx in date_col_indexes:
            for row in range(2, ws.max_row + 1):
                cell = ws.cell(row=row, column=col_idx)
                if cell.value is not None and cell.value != "":
                    cell.number_format = "DD/MM/YYYY"

def print_startup_logs(LPP_EQUIV, LPP_PRICE_EUR, LPP_QTE_ATTENDUE, LPP_SEUIL_TYPE, sag=None):
    print("=== Config chargée ===")
    print(f"Equivalences LPPR: {len(LPP_EQUIV)}")
    print(f"Tarifs LPPR: {len(LPP_PRICE_EUR)}")
    print(f"Qté attendue paramétrée: {len(LPP_QTE_ATTENDUE)}")
    print(f"Seuil_type paramétré: {len(LPP_SEUIL_TYPE)}")

    if sag is not None:
        print("\n=== SAG ===")
        print(f"Lignes SAG: {len(sag)}")
        if "sag_exclu" in sag.columns:
            print(f"Lignes SAG exclues: {int(sag['sag_exclu'].sum())}")

print_startup_logs(LPP_EQUIV, LPP_PRICE_EUR, LPP_QTE_ATTENDUE, LPP_SEUIL_TYPE)

print_startup_logs(LPP_EQUIV, LPP_PRICE_EUR, LPP_QTE_ATTENDUE, LPP_SEUIL_TYPE, sag=sag)
