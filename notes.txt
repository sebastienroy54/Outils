def write_copy_with_values_to_patron(df, patron_path, output_path):

    copyfile(patron_path, output_path)

    wb = load_workbook(filename=str(output_path))
    ws = wb.active

    # Trouver ligne d’en-têtes
    header_row = None
    for r in range(1, 20):
        values = [(ws.cell(row=r, column=c).value or "").strip().lower()
                  for c in range(1, ws.max_column + 1)]
        if "site" in values and "uma" in values:
            header_row = r
            break
    if not header_row:
        header_row = 1  # sécurité

    # Mapper colonnes
    name_to_col = {}
    for c in range(1, ws.max_column + 1):
        val = ws.cell(row=header_row, column=c).value
        if val:
            name_to_col[val.strip().lower()] = c

    col_mois = name_to_col.get("rum du mois")
    col_cum = name_to_col.get("rum cumulés")

    if not col_mois or not col_cum:
        raise KeyError("Colonnes RUM absentes dans le patron")

    start = header_row + 1

    # Injecter données dans la copie
    for i in range(len(df)):
        row = start + i
        ws.cell(row=row, column=col_mois).value = int(df.at[i, "RUM du mois"])
        ws.cell(row=row, column=col_cum).value = int(df.at[i, "RUM cumulés"])

    wb.save(output_path)
