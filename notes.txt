SELECT
    t.NOIP AS IPP,
    t.NODA AS NDA_1er_HDJ,
    t.D8EEUE AS DATE_ENTREE_1er_HDJ
FROM (
    SELECT
        r.NOIP,
        r.NODA,
        r.D8EEUE,
        ROW_NUMBER() OVER (PARTITION BY r.NOIP ORDER BY r.D8EEUE ASC) AS rn
    FROM RSM r, DGN d, EPI e
    WHERE r.KYRES = d.KYRES
      AND r.NODA = e.KYNODA
      AND d.KYCDDG IN ('M321','M329')
      AND e.CDURM_P = '010J'
      AND r.D8EEUE >= TO_DATE('01/12/2018','DD/MM/YYYY')
) t
WHERE t.rn = 1
ORDER BY t.D8EEUE;
