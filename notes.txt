# Parmi les absents dont NDA est présent dans SAG
tmp = abs_action[abs_action["NDA présent dans SAG"] == True]

# Séjours SAG correspondants
sag_ndas = set(tmp["NDA"])

sag_subset = sag[sag["nda"].isin(sag_ndas)]

print("\n=== Diagnostic LPP sur NDA présents ===")
print("Lignes SAG sur ces NDA:", len(sag_subset))
print("Dont LPP vide:", int((sag_subset["lpp"] == "").sum()))
print("Dont LPP non vide:", int((sag_subset["lpp"] != "").sum()))
