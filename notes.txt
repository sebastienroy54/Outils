if res.empty:
    pd.DataFrame([{col: "N/A" for col in cols}]).to_excel(output_excel, index=False)
else:
    with pd.ExcelWriter(output_excel, engine='openpyxl') as writer:
        for groupe in ["VRAI_DOUBLON","DOUBLON_0_NUIT","CONTIGUS","CHEVAUCHEMENT"]:
            subset = res[res["TYPE_RELATION"] == groupe]
            if subset.empty:
                pd.DataFrame([{col: "N/A" for col in cols}]).to_excel(writer, sheet_name=groupe[:31], index=False)
            else:
                subset.to_excel(writer, sheet_name=groupe[:31], index=False)
