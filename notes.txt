SELECT
    COUNT(DISTINCT R.NOIP) AS NB_IPP
FROM
    RSM R,
    DGN D
WHERE
    D.KYRES(+) = R.KYRES
    AND R.CDURM_P = '520J'
    AND (
        R.CDDNC9  LIKE 'M545%'
     OR R.CDRELIE LIKE 'M545%'
     OR D.KYCDDG  LIKE 'M545%'
    )
    AND R.D8EEUE >= TO_DATE('01/01/2024','DD/MM/YYYY')
    AND R.D8EEUE <  TO_DATE('01/01/2025','DD/MM/YYYY');
