    # ... après avoir rempli rows ...

    expected_rel_cols = [
        "IPP", "DATE_NAISSANCE",
        "NDA1", "UMA1", "GHM1", "DATEE1", "DATES1",
        "NDA2", "UMA2", "GHM2", "DATEE2", "DATES2",
        "TYPE_RELATION"
    ]

    res = pd.DataFrame(rows)

    # Si aucun résultat: DataFrame vide sans colonnes -> on force le schéma
    if res.empty:
        res = pd.DataFrame(columns=expected_rel_cols)

    # Si jamais une colonne manque (sécurité), on la crée
    for c in expected_rel_cols:
        if c not in res.columns:
            res[c] = pd.Series(dtype="object")

    res = res.drop_duplicates().reset_index(drop=True)
    res["PAIR_ID"] = res.index + 1
    return res
