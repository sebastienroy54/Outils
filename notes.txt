SELECT A.KYCDAC, COUNT(DISTINCT R.KYRES) AS NB
FROM RSM R, RAC A
WHERE A.KYRES = R.KYRES
AND R.CDURM_P IN ('140J','142J')
AND R.D8EEUE >= TO_DATE('01/01/2024','DD/MM/YYYY')
AND R.D8EEUE <  TO_DATE('01/01/2025','DD/MM/YYYY')
AND A.KYCDAC LIKE 'JNJD%'
GROUP BY A.KYCDAC
ORDER BY NB DESC;
