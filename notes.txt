def safe_read_oracle_spool_csv(csv_path: Path) -> pd.DataFrame:
    # Lit le fichier spooled par SQL*Plus en filtrant les lignes non-CSV.
    raw = csv_path.read_text(encoding="latin-1", errors="ignore").splitlines()

    # On garde uniquement les lignes qui ont au moins 6 séparateurs => 7 colonnes attendues
    kept = [ln for ln in raw if ln.count(";") >= 6]

    if not kept:
        # Aucun contenu exploitable
        return pd.DataFrame(columns=["IPP", "DATE_NAISSANCE", "NDA", "UMA", "GHM", "DATE_ENTREE", "DATE_SORTIE"])

    buf = StringIO("\n".join(kept))

    # On lit sans header “intelligent” : on force dtype=str et sep=';'
    df = pd.read_csv(
        buf,
        sep=";",
        header=0,          # la 1ère ligne kept est normalement l'entête (HEADING ON)
        dtype=str,
        engine="python"
    )

    return df
