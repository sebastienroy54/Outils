        # Infos environnement (très utile en Docker)
        try:
            w = subprocess.run(["which", "sqlplus"], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
            dbg_append(f"which sqlplus: {w.stdout.strip()} {w.stderr.strip()}")
        except Exception as e:
            dbg_append(f"which sqlplus failed: {e}")

        dbg_append(f"PATH: {subprocess.run(['sh','-lc','echo $PATH'], stdout=subprocess.PIPE, text=True).stdout.strip()}")
        dbg_append(f"ORACLE_HOME: {subprocess.run(['sh','-lc','echo $ORACLE_HOME'], stdout=subprocess.PIPE, text=True).stdout.strip()}")
        dbg_append(f"LD_LIBRARY_PATH: {subprocess.run(['sh','-lc','echo $LD_LIBRARY_PATH'], stdout=subprocess.PIPE, text=True).stdout.strip()}")

        # Commande réelle (on masque le password)
        dbg_append("Command (password masked):")
        dbg_append(f"sqlplus -S {user}/******@{dsn} @{test_sql_path}")
