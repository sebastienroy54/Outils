def export_excel_with_date_formats(df: pd.DataFrame, out_path: str, sheet_name: str = "data"):
    with pd.ExcelWriter(out_path, engine="openpyxl") as writer:
        df.to_excel(writer, index=False, sheet_name=sheet_name[:31])
        ws = writer.sheets[sheet_name[:31]]
        headers = [cell.value for cell in ws[1]]

        date_cols = {"Date de pose", "Date de naissance", "Date fichcomp", "SAG Date"}
        date_col_indexes = [i + 1 for i, h in enumerate(headers) if h in date_cols]

        for col_idx in date_col_indexes:
            for row in range(2, ws.max_row + 1):
                cell = ws.cell(row=row, column=col_idx)
                if cell.value is not None and cell.value != "":
                    cell.number_format = "DD/MM/YYYY"
