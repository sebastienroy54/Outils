SELECT A2.KYCDAC, COUNT(DISTINCT A2.KYRES) AS NB_SEJOURS
FROM RAC A1, RAC A2, RSM R
WHERE A1.KYRES = A2.KYRES
AND A1.KYRES = R.KYRES
AND R.CDURM_P IN ('140J','142J')
AND R.D8EEUE >= TO_DATE('01/01/2024','DD/MM/YYYY')
AND R.D8EEUE <  TO_DATE('01/01/2025','DD/MM/YYYY')
AND A1.KYCDAC = 'JNJD002'
GROUP BY A2.KYCDAC
ORDER BY NB_SEJOURS DESC;
