def export_excel_multi_sheets_with_date_formats(sheets: dict[str, pd.DataFrame], out_path: str):
    with pd.ExcelWriter(out_path, engine="openpyxl") as writer:
        for sheet_name, df in sheets.items():
            df.to_excel(writer, index=False, sheet_name=sheet_name[:31])  # Excel limite Ã  31 chars
            ws = writer.sheets[sheet_name[:31]]
            headers = [cell.value for cell in ws[1]]

            date_cols = {"Date de pose", "Date de naissance", "Date fichcomp", "SAG Date"}
            date_col_indexes = [i + 1 for i, h in enumerate(headers) if h in date_cols]

            for col_idx in date_col_indexes:
                for row in range(2, ws.max_row + 1):
                    cell = ws.cell(row=row, column=col_idx)
                    if cell.value is not None and cell.value != "":
                        cell.number_format = "DD/MM/YYYY"
