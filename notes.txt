SELECT KYRES, COUNT(*) NB_DAS
FROM DGN,
     (SELECT DISTINCT RSM.KYRES KYRES
      FROM RSM, RUM
      WHERE RSM.KYRES=RUM.NORES
        AND RUM.D8SOUE>=TO_DATE('01/01/2025','DD/MM/YYYY')
        AND RUM.D8SOUE< TO_DATE('01/01/2026','DD/MM/YYYY')
        AND RSM.CDURM_P IN ('071S','071')) K
WHERE DGN.KYRES=K.KYRES
GROUP BY KYRES
HAVING COUNT(*)>20
ORDER BY NB_DAS DESC;
